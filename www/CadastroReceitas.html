<!DOCTYPE html>
<html>
<head>
   <title>Cadastro de Receitas/Despesas</title>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">

   <link rel="stylesheet" type="text/css" href="font-awesome/css/font-awesome.min.css"/>
   <link rel="stylesheet" type="text/css" href="jquery/jquery.mobile-1.4.5.min.css"/>
   <link rel="stylesheet" type="text/css" href="jquery/jquery-ui.min.css"/>

   <link rel="stylesheet" type="text/css" href="jquery/custom-theme.min.css"/>
   <link rel="stylesheet" type="text/css" href="jquery/jquery.mobile.icons.min.css"/>
   <link rel="stylesheet" type="text/css" href="jquery/jquery.mobile.structure-1.4.5.min.css"/>

   <link rel="stylesheet" href="css/my-app.css">
</head>
<body >
   <div data-role="page" data-theme="b">
      <div data-role="header">
         <a href="index.html" data-icon="back" data-rel="back" data-iconpos="notext"></a>
         <h5>Economy +</h5>
      </div>
      <div data-role="content" >

          <div data-role="fieldcontain">
            <label for="select-tipo" class="select">Tipo</label>
            <select name="select-tipo" id="select-tipo" data-native-menu="false" data-mini="true">
              <option value="0">Tipo</option>
              <option value="1">Despesa</option>
              <option value="2">Receita</option>
            </select>
         </div>

         <div data-role="fieldcontain">
            <label for="select-categoria" class="select">Categoria</label>
            <select name="select-categoria" id="select-categoria" data-native-menu="false" data-mini="true">
            </select>
         </div>

         <div data-role="">
           <label for="txtData">Data</label>  
           <input id="txtData" name="txtData" type="text" readonly />
         </div>

         <div data-role="">
           <label for="txtValor">Valor (R$)</label>  
           <input type="number" name="txtValor" pattern="[0-9]*" id="txtValor" value="0,00">
         </div>

         <div data-role="">
           <label for="txtQtdParcela">Qtde. Parcelas</label>  
           <input type="number" name="txtQtdParcela" pattern="[0-9]*" id="txtQtdParcela" value="1">
         </div>

         <div data-role="fieldcontain">
           <label for="txtObservacao">Observação</label>  
           <textarea cols="40" rows="8" name="txtObservacao" id="txtObservacao" ></textarea>
         </div>                    
                     
         <input type="button" value="Cadastrar" onclick="CadastrarReceitaDespesa()">

      </div>
   </div>

   <script type="text/javascript" src="cordova.js"></script>

   <script type="text/javascript" charset="utf-8" src="jquery/jquery-1.11.3.min.js"></script>
   <script type="text/javascript" charset="utf-8" src="jquery/jquery.mobile-1.4.5.min.js"></script>
   <script type="text/javascript" charset="utf-8" src="jquery/jquery-ui.min.js"></script>
   
   <script type="text/javascript" src="js/my-app.js"></script>
   <script type="text/javascript" src="js/my-app-banco.js"></script>

   

   <script type="text/javascript">

      $( "#txtData" ).datepicker({
         dateFormat: "dd/mm/yy"
      });

      $("#select-tipo").change(function(){
        CarregarCategoria($("#select-tipo").val());
      });

      function CarregarCategoria(tipo){
        var resultado = function(result) {
          $('#select-categoria').empty();
          var sltTipoPagamentoDespesa = document.getElementById("select-categoria");
          for (var i = 0; i < result.length; i++){
            sltTipoPagamentoDespesa.options[i] = new Option(result[i].Descricao, result[i].Id);
          }
          $("#select-categoria").selectmenu("refresh", true);
        };

        BuscarCategoria(resultado, tipo);
      }

      function CadastrarReceitaDespesa(){
        //alert("cadastro");
         var id = 0; // pois esta salvando, quando editar passa o id
         var tipo = $('#select-tipo').val(); // receita ou despesa
         
          if(tipo <= 0){
            alert("Selecione um tipo!");
            return;
         }

         var categoria = $('#select-categoria').val(); // id da categoria

          if(categoria <= 0){
            alert("Selecione uma categoria!");
            return;
         }

         var valor = $('#txtValor').val();


        if(valor.trim() == ""){
            alert("Digite um valor!");
            return;
         }
         
         var data = $('#txtData').val();

          if(data.trim() == ""){
            alert("Digite uma data!");
            return;
         }

         var qtdParcelas = $('#txtQtdParcela').val();
         var observacao = $('#txtObservacao').val();

           

        
         SalvarReceitaDespesa(id, tipo, categoria, valor, data, qtdParcelas, observacao);
      }

   </script>

</body>
</html>